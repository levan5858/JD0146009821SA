<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="adminTitle">لوحة التحكم - AL SAHRA PRECIOUS METALS</title>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="icon" type="image/svg+xml" href="../logo.svg">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
</head>
<body>
    <header>
        <div class="container">
            <a href="/" class="logo-link">
                <div class="logo">
                    <img src="../logo.svg" alt="AL SAHRA Logo" class="logo-img">
                    <div class="logo-text">
                        <h1>AL SAHRA PRECIOUS METALS & LOGISTICS</h1>
                        <p class="tagline" data-i18n="taglineAdmin">لوحة التحكم</p>
                    </div>
                </div>
            </a>
            <nav>
                <button class="mobile-menu-toggle" id="mobileMenuToggle" aria-label="Menu">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
                <ul class="nav-menu" id="navMenu">
                    <li><a href="/" data-i18n="navHome">الرئيسية</a></li>
                    <li><a href="/tracking" data-i18n="navTracking">تتبع الشحنة</a></li>
                    <li><a href="/zip-lookup" data-i18n="navZipLookup">البحث عن الرمز البريدي</a></li>
                    <li><a href="/calculate-price" data-i18n="navCalculatePrice">حساب السعر</a></li>
                    <li><a href="/schedule-pickup" data-i18n="navSchedulePickup">جدولة الاستلام</a></li>
                    <li><a href="/contact" data-i18n="navContact">اتصل بنا</a></li>
                    <li><a href="/admin" class="active" data-i18n="navAdmin">لوحة التحكم</a></li>
                </ul>
                <div class="language-switcher">
                    <button class="lang-btn" onclick="setLanguage('ar')" id="lang-ar">العربية</button>
                    <button class="lang-btn" onclick="setLanguage('en')" id="lang-en">English</button>
                </div>
            </nav>
        </div>
    </header>

    <main>
        <!-- Login Section -->
        <section id="loginSection" class="login-section">
            <div class="container">
                <div class="login-box">
                    <h2 data-i18n="loginTitle">تسجيل الدخول</h2>
                    <form id="loginForm">
                        <div class="form-group">
                            <label for="username" data-i18n="labelUsername">اسم المستخدم:</label>
                            <input type="text" id="username" required autocomplete="username">
                        </div>
                        <div class="form-group">
                            <label for="password" data-i18n="labelPassword">كلمة المرور:</label>
                            <input type="password" id="password" required autocomplete="current-password">
                        </div>
                        <div id="loginError" class="error-message" style="display: none;"></div>
                        <button type="submit" class="btn-primary" data-i18n="loginButton">تسجيل الدخول</button>
                    </form>
                </div>
            </div>
        </section>

        <!-- Admin Section (Hidden until authenticated) -->
        <section id="adminSection" class="admin-section" style="display: none;">
            <div class="container">
                <div class="admin-header">
                    <h2 data-i18n="adminTitle">لوحة التحكم - إدارة الشحنات</h2>
                    <button id="logoutBtn" class="btn-logout" data-i18n="logoutButton">تسجيل الخروج</button>
                </div>

                <div class="admin-tabs">
                    <button class="tab-btn active" data-tab="create" data-i18n="tabCreate">إنشاء شحنة جديدة</button>
                    <button class="tab-btn" data-tab="manage" data-i18n="tabManage">إدارة الشحنات</button>
                </div>

                <!-- Create Shipment Tab -->
                <div id="createTab" class="tab-content active">
                    <form class="admin-form" id="createShipmentForm">
                        <h3 data-i18n="createTitle">إنشاء شحنة جديدة</h3>
                        <div class="form-group">
                            <label for="newTrackingNumber" data-i18n="labelTrackingNumber">رقم التتبع:</label>
                            <input type="text" id="newTrackingNumber" required>
                        </div>
                        <div class="form-group">
                            <label for="recipientName" data-i18n="labelRecipientName">اسم المستلم:</label>
                            <input type="text" id="recipientName" required>
                        </div>
                        <div class="form-group">
                            <label for="recipientAddress" data-i18n="labelRecipientAddress">عنوان المستلم:</label>
                            <textarea id="recipientAddress" required></textarea>
                        </div>
                        <div class="form-group">
                            <label for="senderName" data-i18n="labelSenderName">اسم المرسل:</label>
                            <input type="text" id="senderName" required>
                        </div>
                        <div class="form-group">
                            <label for="senderAddress" data-i18n="labelSenderAddress">عنوان المرسل:</label>
                            <textarea id="senderAddress" required></textarea>
                        </div>
                        <div class="form-group">
                            <label for="shipmentWeight" data-i18n="labelWeight">الوزن (كجم):</label>
                            <input type="number" id="shipmentWeight" step="0.01" required>
                        </div>
                        <div class="form-group">
                            <label for="shipmentDescription" data-i18n="labelDescription">وصف الشحنة:</label>
                            <textarea id="shipmentDescription"></textarea>
                        </div>
                        <div class="form-group">
                            <label data-i18n="labelTags">العلامات (Tags):</label>
                            <div class="tags-container">
                                <div class="tags-input-container">
                                    <input type="text" id="tagInput" placeholder="أدخل علامة واضغط Enter" data-i18n="tagInputPlaceholder">
                                    <button type="button" class="btn-add-tag" onclick="addTag()" data-i18n="addTag">إضافة</button>
                                </div>
                                <div class="tags-preview" id="tagsPreview"></div>
                                <div class="tags-suggestions">
                                    <small data-i18n="tagSuggestions">اقتراحات:</small>
                                    <div class="tag-suggestion-list">
                                        <span class="tag-suggestion" onclick="addSuggestedTag('High-Value Consignment')">High-Value Consignment</span>
                                        <span class="tag-suggestion" onclick="addSuggestedTag('Secured Transport')">Secured Transport</span>
                                        <span class="tag-suggestion" onclick="addSuggestedTag('Special Handling Required')">Special Handling Required</span>
                                        <span class="tag-suggestion" onclick="addSuggestedTag('Fragile')">Fragile</span>
                                        <span class="tag-suggestion" onclick="addSuggestedTag('Express')">Express</span>
                                        <span class="tag-suggestion" onclick="addSuggestedTag('Insurance Required')">Insurance Required</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <button type="submit" class="btn-primary" data-i18n="createButton">إنشاء الشحنة</button>
                    </form>
                </div>

                <!-- Manage Shipments Tab -->
                <div id="manageTab" class="tab-content">
                    <div class="search-box">
                        <input type="text" id="searchTracking" data-i18n="searchPlaceholder" placeholder="ابحث برقم التتبع...">
                        <button id="searchBtn" data-i18n="searchButton">بحث</button>
                    </div>

                    <div id="shipmentList" class="shipment-list">
                        <!-- Shipments will be listed here -->
                    </div>

                    <div id="editShipmentModal" class="modal" style="display: none;">
                        <div class="modal-content">
                            <span class="close-modal" onclick="closeEditModal()">&times;</span>
                            <h3 data-i18n="editStatusTitle">تعديل حالة الشحنة</h3>
                            <form id="updateStatusForm">
                                <div class="form-group">
                                    <label data-i18n="addNewStatus">إضافة حالة جديدة:</label>
                                    <select id="newStatus">
                                        <option value="pending" data-i18n="statusPending">قيد الانتظار</option>
                                        <option value="picked_up" data-i18n="statusPickedUp">تم الاستلام</option>
                                        <option value="in_transit" data-i18n="statusInTransit">قيد النقل</option>
                                        <option value="out_for_delivery" data-i18n="statusOutForDelivery">قيد التوصيل</option>
                                        <option value="delivered" data-i18n="statusDelivered">تم التسليم</option>
                                        <option value="exception" data-i18n="statusException">استثناء</option>
                                    </select>
                                    <small style="color: #666; display: block; margin-top: 0.5rem;" data-i18n="statusNote">يمكنك اختيار أي حالة، حتى العودة إلى حالة سابقة</small>
                                </div>
                                <div class="form-group">
                                    <label data-i18n="labelLocation">الموقع:</label>
                                    <input type="text" id="statusLocation" required>
                                </div>
                                <div class="form-group">
                                    <label data-i18n="labelDateTime">التاريخ والوقت:</label>
                                    <input type="datetime-local" id="statusDateTime" required>
                                </div>
                                <div class="form-group">
                                    <label data-i18n="labelNotes">ملاحظات (مطلوب للعودة إلى حالة سابقة):</label>
                                    <textarea id="statusNotes" placeholder="أدخل السبب أو التفاصيل"></textarea>
                                </div>
                                <button type="submit" class="btn-primary" data-i18n="addStatusButton">إضافة الحالة</button>
                            </form>
                        </div>
                    </div>

                    <div id="editDescriptionModal" class="modal" style="display: none;">
                        <div class="modal-content">
                            <span class="close-modal" onclick="closeEditDescriptionModal()">&times;</span>
                            <h3 data-i18n="editDescriptionTitle">تعديل وصف الشحنة</h3>
                            <form id="updateDescriptionForm">
                                <div class="form-group">
                                    <label data-i18n="labelDescription">وصف الشحنة:</label>
                                    <textarea id="editDescriptionText" rows="5"></textarea>
                                </div>
                                <button type="submit" class="btn-primary" data-i18n="saveDescription">حفظ الوصف</button>
                            </form>
                        </div>
                    </div>

                    <div id="editTagsModal" class="modal" style="display: none;">
                        <div class="modal-content">
                            <span class="close-modal" onclick="closeEditTagsModal()">&times;</span>
                            <h3 data-i18n="editTagsTitle">تعديل العلامات</h3>
                            <div class="tags-container">
                                <div class="tags-input-container">
                                    <input type="text" id="editTagInput" placeholder="أدخل علامة واضغط Enter" data-i18n="tagInputPlaceholder">
                                    <button type="button" class="btn-add-tag" onclick="addEditTag()" data-i18n="addTag">إضافة</button>
                                </div>
                                <div class="tags-preview" id="editTagsPreview"></div>
                                <div class="tags-suggestions">
                                    <small data-i18n="tagSuggestions">اقتراحات:</small>
                                    <div class="tag-suggestion-list">
                                        <span class="tag-suggestion" onclick="addEditSuggestedTag('High-Value Consignment')">High-Value Consignment</span>
                                        <span class="tag-suggestion" onclick="addEditSuggestedTag('Secured Transport')">Secured Transport</span>
                                        <span class="tag-suggestion" onclick="addEditSuggestedTag('Special Handling Required')">Special Handling Required</span>
                                        <span class="tag-suggestion" onclick="addEditSuggestedTag('Fragile')">Fragile</span>
                                        <span class="tag-suggestion" onclick="addEditSuggestedTag('Express')">Express</span>
                                        <span class="tag-suggestion" onclick="addEditSuggestedTag('Insurance Required')">Insurance Required</span>
                                    </div>
                                </div>
                            </div>
                            <button type="button" class="btn-primary" onclick="saveTags()" data-i18n="saveTags">حفظ العلامات</button>
                        </div>
                    </div>

                    <div id="viewStatusHistoryModal" class="modal" style="display: none;">
                        <div class="modal-content">
                            <span class="close-modal" onclick="closeStatusHistoryModal()">&times;</span>
                            <h3 data-i18n="statusHistoryTitle">سجل الحالات</h3>
                            <div id="statusHistoryList" class="status-history-list">
                                <!-- Status history will be listed here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3 data-i18n="companyInfo">معلومات الشركة</h3>
                    <p><strong>AL SAHRA PRECIOUS METALS & LOGISTICS LLC</strong></p>
                    <p data-i18n="addressArabic">طريق الملك فهد، حي العليا</p>
                    <p>King Fahd Road, Al Olaya District</p>
                    <p><span data-i18n="crNumber">الرقم الموحد:</span> 1010894457</p>
                </div>
                <div class="footer-section">
                    <h3 data-i18n="contactUs">اتصل بنا</h3>
                    <p><span data-i18n="phone">الهاتف:</span> <a href="tel:+966114872290">+966 11 487 2290</a></p>
                    <p><span data-i18n="email">البريد الإلكتروني:</span> <a href="mailto:export@alsahrapml.com">export@alsahrapml.com</a></p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 AL SAHRA PRECIOUS METALS & LOGISTICS LLC. <span data-i18n="copyright">جميع الحقوق محفوظة.</span></p>
            </div>
        </div>
    </footer>

    <script src="../js/firebase-config.js"></script>
    <script src="../js/database.js"></script>
    <script src="../js/translations.js"></script>
    <script src="../js/mobile-menu.js"></script>
    <script src="../js/auth.js"></script>
    <script src="../js/admin.js"></script>
</body>
</html>

